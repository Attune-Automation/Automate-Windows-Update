Get-WUHistory -Last 15

# Define a variable to filter for updates
$SecurityUpdates = Get-WindowsUpdate -Category "Security"

# Check if there are missing updates
if ($SecurityUpdates.Count -gt 0) {
    Write-Host "Missing Security Updates:"
    
    # List the missing security updates
    $SecurityUpdates | ForEach-Object {
        Write-Host "KB$($_.KBArticleID): $($_.Title)"
    }
    Write-Error "Please investigate why the security updates were not installed."
} else {
    Write-Host "Success! All security updates are installed."
}
